<html>
    <head>
        <title>Maybe the problem isn't "Fat Model"</title>
        <meta name="author" content="Miguel San Rom&aacute;n">
        <meta name="description" content=Maybe the problem isn't "Fat Model">
        <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
        <link rel="icon" href="/favicon.ico" />
        <link href='http://fonts.googleapis.com/css?family=Quando|Telex' rel='stylesheet' type='text/css'>
        <link href="../css/style.css" rel="stylesheet" media="screen and (min-width:1200px)">
        <link href="../css/medium.css" rel="stylesheet" media="screen and (max-width:1199px)">
        <link href="../css/font-awesome.css" rel="stylesheet" media="screen">
        <!--[if IE 7]>
            <link href="/css/font-awesome-ie7.css" rel="stylesheet" media="screen">
        <![endif]-->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script src="../js/modernizr-custom.js"></script>
    </head>
    <body>
        <section class="sidebar">
            <div class="avatar-container">
                <a href="/">
                    <img src="http://www.gravatar.com/avatar/b9658e531ce58a80bc981e5f375c7759.jpg" class="avatar" alt="Miguel San Rom&aacute;n">
                </a>
            </div>
            <section class="name"><a href="/">Miguel San Rom&aacute;n</a></section>
            <section class="meta">
                <a title="GitHub" href="http://github.com/msanroman" target="_blank">
                    <span class="icon-github github"></span>
                </a>
                <a title="Twitter" href="http://twitter.com/xtremevoodoo" target="_blank">
                    <span class="icon-twitter twitter"></span>
                </a>
                <a title="YouTube" href="http://youtube.com/endymiion" target="_blank">
                    <span class="icon-music music"></span>
                </a>
                <a title="Instagram" href="http://instagram.com/msanroman" target="_blank">
                    <span class="icon-camera-retro instagram"></span>
                </a>
            </section>
            <nav>
                <ul>
                    <li>
                        <a href="/about.html">
                            &raquo; who am I?
                        </a>
                    </li>
                    <li>
                        <a href="/">
                            &raquo; articles
                        </a>
                    </li>
                </ul>
            </nav>
        </section>
            <section class="content">
        <h1>
            Maybe the problem isn't "Fat Model"
        </h1>
        <p class="post-time">December 28, 2012</p>
        <section class="post">
            <p><em>(well, it isn't the root of it)</em></p>

<h2>Madrid.rb</h2>

<p>Since I am in Madrid during Christmas, I attended the event organized yesterday by <a href="https://madridrb.jottit.com/">madrid.rb</a>. If you don't know them, it's a Ruby user group in Madrid, and they share knowledge and beers on a monthly basis.</p>

<p>If you like Ruby, beers and it turns out you're in Madrid, I sincerely recommend you to step by one of their events. It's always a pleasure to have a little chat and share your point of view with the others.</p>

<p>Yesterday's talk was about Fat Models, or the inherent problems caused by following the "Skinny Controller, Fat Model" Ruby on Rails' practice. The speaker, <a href="http://twitter.com/cavalle">Luismi Cavall&eacute;</a> did a great job talking about this problematic and the different solutions offered by the Rails community.</p>

<p>This is an issue in everyone's lips right now, and I loved watching the proactivity of the community sharing problems, tips and tricks.</p>

<h2>ActiveRecord feels wrong to me</h2>

<p>The <em>Fat Model, Skinny Controller</em> thing is great under the point of view that business logic doesn't belong to the controller, but I'm sorry mixing persistence with business logic feels wrong to me. Why? Mainly because your classes:</p>

<ul>
<li>Have now <strong>two</strong> responsibilities, persist and <em>do-whatever-they-say-they-do</em></li>
<li>There won't be any unit test for them, since you are coupled to the database. As a side effect:

<ul>
<li>Your tests will be brittle, they can break now by a business logic problem or by a persistence problem.</li>
<li>Your test suite is gonna run up to 10/15/20 minutes. Are you gonna run them always after each change, each refactor?</li>
<li>Your tests won't be the safety net they are supposed to be.</li>
</ul>
</li>
<li>You will end up being unable to manage that big, fat model.</li>
</ul>


<p>[Almost all] applications aren't <em>only</em> a CRUD. They are much more. They have exclusive business rules and most of them don't have to do anything about a database, nor a deploying system, nor a framework. Those are implementation details, and you should decide about them in your last responsible moment.</p>

<p>And I think <strong>Rails doesn't help with this point of view</strong>.</p>

<p>Don't get me wrong. <strong>I love Rails</strong>, but being a database-centric framework makes unconfortable form me to try to <em>hack</em> against the <em>Rails-way</em> when I try to keep my domain logic and my persistence rules and validators separated.</p>

<p>Yeah, I know, you can keep that domain logic out of the model creating modules for that logic, or using the new ActiveSupport::Concern thing. It will make that logic easier to test, and your models will look skinnier than ever.</p>

<p>But you still have your models and domain coupled to the framework, and that looks dangerous to me. Specially if your test suite is not powerful enough to guarantee that after a change in the framework, or in the database (or any other <em>implementation detail</em>) your domain is still working.</p>

<h2>Not-so-skinny-controller? Really?</h2>

<p>I agree with DHH on <a href="http://david.heinemeierhansson.com/2012/emails-are-views.html">one of his last posts'</a> title: keep emails out of the models! But (IMHO) the controller is not the place to put them.</p>

<p>The controller must handle requests and return responses <strong>nothing more</strong>. They should call to certain domain modules depending on the request they are handling at that moment, and return the response that domain module sent them.</p>

<p>Sending emails or managing subscriptions doesn't seem like a controller's job.</p>

<h2>Wrap up</h2>

<p>I still have to do more experiments and detect what's the real pain for me there. I just kept feeling like the topic we were discussing yesterday was mainly because we choose a framework when we start developing our application, and not when we really need it.</p>

<p>All in all, yesterday's meetup was great, and I had the pleasure to meet some people like <a href="https://twitter.com/ArturoHerrero">@ArturoHerrero</a>, <a href="https://twitter.com/cavalle">@cavalle</a>, <a href="https://twitter.com/ecomba">@ecomba</a>, <a href="https://twitter.com/elobatoss">@eLobatoss</a>, <a href="https://twitter.com/germandz">@germandz</a>, <a href="https://twitter.com/pasku1">@pasku1</a> and much more. We didn't talk only about this problem, and each topic we talked was enriching for me.</p>

<p>So thanks to all of you!</p>

        </section>
    </section>
    <script src="../js/scrolling-header.js"></script>
    </body>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-37318526-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</html>